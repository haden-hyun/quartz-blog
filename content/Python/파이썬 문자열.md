---
title: 파이썬 열 목록 추출
created: 2024-06-05
modified: 2024-06-05 08:13
cssclasses:
  - max
tags:
  - python
  - python/열추출
  - python/startswith
  - pytohn/endswith
  - python/contains
---
## 특정 문자로 시작 or 끝이 나는 열 추출

> [!summary] 요약
> - 조건 1개: `startswith`, `endswith` 활용
> - 조건 2개 이상: `contains`함수와 정규표현식 활용
> - 단, `df.columns`에 직접 접근하여 조건문 만족여부에 대한 Boolean 값을 반환
> - 따라서, `df.loc` 활용하여 인덱싱이 필요함
#### 1) 조건 1개
- `music_`로 시작하는 열 만 가져오기
- `_movie`로 끝나는 열 만 가져오기
```python
start_cols = df.columns.str.startswith('music_')
end_cols = df.columns.str.endswith('_movie')

music_df = df.loc[:, start_cols]
movie_df = df.loc[:, end_cols]
```
#### 2) 조건 2개 이상
- `apple_`, `banana_`로 시작하는 열 만 가져오기: `^`활용
- `_brix`, `_size`로 끝나는 열 만 가져오기: `$`
```python
start_cols = df.columns.str.contains('^apple_|^banana_', regex = True)
end_cols = df.columns.str.contains('_brix$|_size$', regex = True)

fruits_df = df.loc[:, start_cols]
nutrient_df = df.loc[:, end_cols]
```

## 문자열 구분
>[!summary] 요약
>- 목적: 문자열 값을 특정 조건에 맞춰 문자열 값을 분리함
>- 특정 문자로 구분: `str.split()` 활용
>- 정규표현식으로 구분: `str.extract()` 활용
#### 1) 특정 문자로 구분
>[!warning] `split()` 반환값: `list`
>- 함수구조: `str.split(sep = '구분자', maxsplit = '분할횟수')`
>	- 단, 데이터프레임의 특정 열에 직접 적용할 경우 해당 인자 적용안됨
>- `expand = True` : 결과값 > 데이터프레임

```python
df = df.assign(  
    basic = df['col'].str.split(','),  
    basic_len = lambda df: df['basic'].str.len(),  
    
    ver1 = df['col'].apply(lambda x: x.split(sep = ',')),  
    ver1_len = lambda df: df['ver1'].str.len(),  
    
    ver2 = df['col'].apply(lambda x: x.split(sep = ',', maxsplit = 1)),  
    ver2_len = lambda df: df['ver2'].str.len()  
)
```

| col                   | basic                        | basic_len | ver1                         | ver1_len | ver2                       | ver2_len |
| --------------------- | ---------------------------- | --------- | ---------------------------- | -------- | -------------------------- | -------- |
| apple,banana,cherry   | `[apple, banana, cherry]`    | 3         | `[apple, banana, cherry]`    | 3        | `[apple, banana,cherry]`   | 2        |
| dog,cat               | `[dog, cat]`                 | 2         | `[dog, cat]`                 | 2        | `[dog, cat]`               | 2        |
| red,blue,green,yellow | `[red, blue, green, yellow]` | 4         | `[red, blue, green, yellow]` | 4        | `[red, blue,green,yellow]` | 2        |
| sun,moon              | `[sun, moon]`                | 2         | `[sun, moon]`                | 2        | `[sun, moon]`              | 2        |

```python
df2 = df['col'].str.split(',', expand = True)  
df2.columns = [f'split_{i}' for i in range(1, len(df2.columns) + 1)]
```

| split_1 | split_2 | split_3 | split_4 |
| ------- | ------- | ------- | ------- |
| apple   | banana  | cherry  | None    |
| dog     | cat     | None    | None    |
| red     | blue    | green   | yellow  |
| sun     | moon    | None    | None    |
#### 2) 정규표현식으로 구분